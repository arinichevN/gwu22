
UDP шлюз для DHT22

1 Установка
1.1 Требования
Функции управления пинами реализованы для процессора Allwinner A20 и H3. Скрипт-установщик
работает в командной оболочке bash.
1.2 Настройки:
- доступ к базе данных настроек: файл main.conf первая строка;
- класс приложения:  файл main.conf вторая строка (используется для извлечения 
  данных из базы данных и позволяет использовать одну и ту же базу данных для 
  нескольких приложений);
- место установки исполняемого файла: файл build.sh константа INST_DIR
- место установки файла конфигурации: файл build.sh константа CONF_DIR (должна соответствовать CONF_DIR из main.h)
- процессор: файл build.sh константа PLATFORM
- путь к заголовочным файлам postgres: файл build.sh константа PSQL_I_DIR
- путь к библиотеке libpq: файл build.sh константа PSQL_L_DIR
- откуда загружать данные (см. п. 2): файл build.sh константа INI_MODE
1.3 Команды для установки:
cd gwu22
Полная установка:
sudo ./build.sh full
Для тестирования (файлы не копируются за пределы текущей папки):
sudo ./build.sh part_debug

2 Настройка базы данных
Если во время построения приложения определена константа FILE_INI, то данные будут извлекаться из файлов 
DEVICE_FILE и CONFIG_FILE из main.h.
Формат CONFIG_FILE:
 port\tpid_path\tudp_buf_size
Формат DEVICE_FILE:
 pin\temperature_sensor_id\thumidity_sensor_id
Если во время построения приложения константа FILE_INI не определена, то используется
СУБД PostgreSQL.
В файле ./sql/main.sql находится структура данных, используемая этим приложением.
Файл ./sql/data_diagram.png позволит лучше понять взаимосвязи между данными.

3 Запуск
При полной установке запускается автоматически, вмести с операционной системой.
sudo gwu22
Если приложение установлено для тестирования:
sudo ./gwu22_dbg

4 Управление
4.1 Список команд
см. ./util.c printHelp()

4.2 Примеры
Для рассылки udp пакетов используется утилита udpcl (https://github.com/arinichevN/udpcl)
Утилита netcat не подходит, так как разрывает пакеты, встречая символ '\n'
Параметры утилиты udpcl следует заменить на свои.

перезагрузка с чтением всех настроек:
echo -e '!&' | udpcl 192.168.1.250 49161 2

запрос температуры для всех датчиков:
echo -e '!a' | udpcl 192.168.1.250 49161 2

запрос температуры для датчика №1 и №2:
echo -e '.a\n1\n2' | udpcl 192.168.1.250 49161 2

